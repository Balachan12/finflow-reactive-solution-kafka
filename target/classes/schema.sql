-- Table: account
CREATE TABLE IF NOT EXISTS account (
    account_id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    document_number VARCHAR(50) NOT NULL UNIQUE,
    credit_limit DECIMAL(19,2) DEFAULT 1000.00,
    available_limit DECIMAL(19,2) DEFAULT 1000.00
);

-- Table: operation_type
CREATE TABLE IF NOT EXISTS operation_type (
    operation_type_id INT PRIMARY KEY,
    description VARCHAR(100) NOT NULL
);

-- Table: transaction
CREATE TABLE IF NOT EXISTS transaction (
    transaction_id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    account_id BIGINT NOT NULL,
    operation_type_id INT NOT NULL,
    amount DECIMAL(19,2) NOT NULL,
    event_date TIMESTAMP NOT NULL,
    CONSTRAINT fk_account FOREIGN KEY (account_id) REFERENCES account(account_id)
);

-- Insert sample operation types
MERGE INTO operation_type (operation_type_id, description) KEY(operation_type_id)
VALUES
  (1, 'PURCHASE'),
  (2, 'INSTALLMENT PURCHASE'),
  (3, 'WITHDRAWAL'),
  (4, 'PAYMENT');
